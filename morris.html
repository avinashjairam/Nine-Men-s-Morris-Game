<html>


<head>


<title>Nine Men's Morris</title>

<link type="text/css" rel="stylesheet" href="./css/stylesheet.css"/>

</head>



<body>
<!-- 
<div id="gameArea">

<img id="coinToss" src="./images/coin.gif" alt="coin toss"/>



</div> -->


<canvas id="gameArea" width="1000" height="1500">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>

var c = document.getElementById("gameArea");
c.addEventListener("mousedown", doMouseDown,false);

function doMouseDown(event){
	mouseX = event.pageX - c.offsetLeft;
	mouseY = event.pageY - c.offsetTop;

	//alert(mouseX + " " + mouseY);


	for(var i =0; i<circles.length; i++){
		if(Math.abs(mouseX-xCoordinates[i]) <=10 && Math.abs(mouseY -yCoordinates[i]) <=10){
		//	alert(circleID[i] + " " + mouseX + " " + mouseY);
			changeColor(circleID[i]);
		}
	}
}
var ctx = c.getContext("2d");

var xSquare1 = 110;
var ySquare1 = 110;

var xSquare2 = 60;
var ySquare2 = 60;

var xSquare3 = 10;
var ySquare3 = 10;

var sizeSquare1 = 200;
var sizeSquare2 = 300;
var sizeSquare3 = 400; 

var topLineY    = [];
var topLineX;

var leftLineX   = [];
var leftLineY;

var bottomLineY = [];
var bottomLineX;

var rightLineX  = [];
var rightLineY;

var key = 0;
//This array stores JSON data for each circle. Each circle has an id, x,y coordinates
var circles = [];


//The following 3 arrays are parallel. 
var circleID = []; 
var xCoordinates = [];
var yCoordinates = [];

//If a player's turn is even change the circle to blue, otherwise red
var playerTurn = 0;

//These two arrays have the circle ids of the pieces which belong to red and blue respectively
//These are pieces which have actually been placed on the board
var redPieces = [];
var bluePieces = [];

var initialRedPiecesY;
var initialRedPieces = [];
var initialBluePiecesY;
var initialBluePieces = [];

var blueCount = 0;
var redCount = 0;
drawSquares();


drawCirclesOnSquares(xSquare1,sizeSquare1);


drawCirclesOnSquares(xSquare2,sizeSquare2);


drawCirclesOnSquares(xSquare3,sizeSquare3);

drawLines();


//alert(leftLineX);
drawPieces();

var json = JSON.stringify(circles);



for(var i =0; i<circles.length; i++){
	circleID[i] = circles[i].id;
	xCoordinates[i] = circles[i].x;
	yCoordinates[i] = circles[i].y;

	console.log(circleID[i] + " " + xCoordinates[i] + " " + yCoordinates[i]);

	//alert(circleID[i] + " " + xCoordinates[i] + " " + yCoordinates[i]);
}
//alert(circles);

function changeColor(id){
	ctx.beginPath();



	if(bluePieces.indexOf(id) > -1 || redPieces.indexOf(id) > -1){
			alert("invalid move!");
	}
	else if(playerTurn%2==0){
		if(blueCount < 9){
			bluePieces.push(id);
			ctx.fillStyle="#0000FF";
			ctx.arc(xCoordinates[id],yCoordinates[id],10,0,2 * Math.PI);
			ctx.closePath();
			ctx.fill();
			blueCount++;
			drawPieces();
			playerTurn++;
			removePieces();
			//alert(blueCount);
		}
		else{
			alert("You must move pieces now!");
		}
	}
	else{
		if(redCount < 9){
			redPieces.push(id);
			ctx.fillStyle="#FF0000";
			ctx.arc(xCoordinates[id],yCoordinates[id],10,0,2 * Math.PI);
			ctx.closePath();
			ctx.fill();
			redCount++;
			drawPieces();
			playerTurn++;
			removePieces();
			//alert(redCount);
		}
		else{
			alert("You must move pieces now!");
		}
	}
	

	

}



//This function draws 3 squares on the screen
function drawSquares(){
	ctx.beginPath();
	ctx.lineWidth=0.5;
	ctx.strokeStyle="#000000";

	ctx.rect(xSquare1, ySquare1, sizeSquare1, sizeSquare1);

	ctx.stroke();

	ctx.rect(xSquare2, xSquare2, sizeSquare2, sizeSquare2);
	ctx.stroke();

	ctx.rect(xSquare3, xSquare3, sizeSquare3, sizeSquare3);
	ctx.stroke();

}

function drawLines(){
	topLineY.push(xSquare1);
	bottomLineY.push(xSquare1+sizeSquare1);
	leftLineX.push(xSquare1);
	rightLineX.push(xSquare1+sizeSquare1);

	topLineY.push(xSquare2);
	bottomLineY.push(xSquare2+sizeSquare2);
	leftLineX.push(xSquare2);
	rightLineX.push(xSquare2+sizeSquare2);


	topLineY.push(xSquare3);
	bottomLineY.push(xSquare1+sizeSquare2);
	leftLineX.push(xSquare3);
	rightLineX.push(xSquare3+sizeSquare3);

	ctx.beginPath();

	//Top Middle Line
	ctx.moveTo(xSquare1+sizeSquare1/2,topLineY[0]);
	ctx.lineTo(xSquare1+sizeSquare1/2,topLineY[2]);
	ctx.stroke();

	//Bottom Middle Line
	ctx.moveTo(xSquare1 +sizeSquare1/2, bottomLineY[0]);
	ctx.lineTo(xSquare1 +sizeSquare1/2, bottomLineY[2]);
	ctx.stroke();

	//Left Horizontal Line
	ctx.moveTo(xSquare1, xSquare1+sizeSquare1/2);
	ctx.lineTo(leftLineX[2],xSquare3 + sizeSquare3/2 );
	ctx.stroke();


	//Right Horizontal Line
	ctx.moveTo(xSquare1+sizeSquare1, xSquare1 + sizeSquare1/2);
	ctx.lineTo(rightLineX[2],xSquare3 + sizeSquare3/2);
	ctx.stroke();


}

//This function is responsible for drawing the circles on the squares
//It receives the coordinates and dimensions of the square as parameters
function drawCirclesOnSquares(coordinate, size){
	var topMiddle=false;
	ctx.beginPath();

	//Top Left Circle
	ctx.arc(coordinate,coordinate,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate,y:coordinate});
	key++;

	//Left Middle Circle
	ctx.arc(coordinate, coordinate + size/2,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate,y:coordinate + size/2});
	key++;


	//Bottom Left Circle
	ctx.arc(coordinate,coordinate + size,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate,y:coordinate + size});
	key++;

	//Top Middle Circle
	topMiddle=true;
	ctx.arc(coordinate + size/2,coordinate,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate + size /2,y:coordinate});
	key++;
    
	//Top Right Circle
	ctx.arc(coordinate + size,coordinate,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate + size,y:coordinate});
	key++;

	//Right Middle Circle
	ctx.arc(coordinate + size, coordinate + size/2,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate + size,y:coordinate + size/2});
	key++;

	//Bottom Right Circle
	ctx.arc(coordinate + size,coordinate + size,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate + size,y:coordinate + size});
	key++;

	//Bottom Middle Circle
	ctx.arc(coordinate + size/2 ,coordinate + size,10,0,2 * Math.PI);
	ctx.closePath();
	ctx.fill();
	circles.push({id:key,x:coordinate + size/2,y:coordinate + size});
	key++;
	

}

function removePieces(){
	ctx.beginPath();
	ctx.fillStyle="#FFFFFF";

	//alert(blueCount + " " + redCount);
	
	for(var i = 0; i < blueCount; i++){
		//alert(initialBluePieces[i] + " " + initialBluePiecesY);
		ctx.arc(initialBluePieces[i], initialBluePiecesY, 10,0,2 * Math.PI);
		ctx.closePath();
		ctx.fill();
	}


	ctx.beginPath();

	for(var i = 0; i < redCount; i++){
		ctx.arc(initialRedPieces[i] ,initialRedPiecesY,10,0,2 * Math.PI);
		ctx.closePath();
		ctx.fill();
	}







}
//This function draws the blue and red pieces on the screen
function drawPieces(){
	ctx.beginPath();
	ctx.fillStyle="#0000FF";

	var blueX = 30;
	var blueY = 470;

	initialBluePiecesY = blueY;

	//alert("hey");
	ctx.font="20px Georgia";
	ctx.fillText("Player", blueX, blueY-20);

	for(var i = 0; i < 9 - bluePieces.length; i++){
		initialBluePieces.push(blueX);
		ctx.arc(blueX ,blueY,10,0,2 * Math.PI);
		blueX += 30;
		ctx.closePath();
		ctx.fill();
	}

	redX = 30;
	redY = 550;

	initialRedPiecesY = redY;

	ctx.fillStyle="#FF0000";
	ctx.fillText("Computer", redX, redY-20);

	ctx.beginPath();

	for(var i = 0; i < 9- redPieces.length; i++){
		initialRedPieces.push(redX);
		ctx.arc(redX ,redY,10,0,2 * Math.PI);
		redX += 30;
		ctx.closePath();
		ctx.fill();
	}


}






</script> 


</body>








</html>